---
title: "Notion APIã¨Next.jsï¼ˆApp directoryã€RSCï¼‰"
emoji: "ğŸ£"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Next.js", "Notion"]
published: false
---

## ã¯ã˜ã‚ã«

å‹‰å¼·ç”¨ã«Notion APIã¨Next.jsã®App Directoryã€RSCã‚’ç”¨ã„ã¦ç°¡å˜ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸã€‚é–“é•ã£ãŸèªè­˜ç­‰ã‚ã‚Šã¾ã—ãŸã‚‰ã€ã”æŒ‡æ‘˜ã„ãŸã ã‘ã‚‹ã¨ã‚ã‚ŠãŒãŸã„ã§ã™ã€‚
https://nextjs13-tryout.vercel.app/
https://github.com/shun1121/nextjs13-tryout

## ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ
```
  .vscode/
  node_modules
  public/
  src/
    app/
      â”œâ”€ components/
      â”‚    â”œâ”€ Header/
      â”‚    â”‚   â”œâ”€ Header.tsx
      â”œâ”€ favicon.ico
      â”œâ”€ globals.css
      â”œâ”€ layout.tsx
      â”œâ”€ page.tsx
  .env
  .gitignore
  next-env.d.ts
  next.config.js
  package.json
  postcss.config.js
  README.md
  tailwind.config.ts
  tsconfig.json
  yarn.lock
```

## Notionã®è¨­å®š

integrationã®ãƒšãƒ¼ã‚¸ã§ã€Œnew integrationã€ã‚’æŠ¼ä¸‹ã—ã€æ–°ã—ãintegrationã‚’ä½œæˆã™ã‚‹ã€‚

https://www.notion.so/my-integration

åå‰ã‚„workspaceã®æŒ‡å®šãªã©å¿…è¦äº‹é …ã‚’è¨˜å…¥ã—ã¾ã™ã€‚
ä»Šå›ã¯Notionã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã‚€ä½œæ¥­ã ã‘ã«ãªã‚‹ã®ã§ã€ã€Œcapabilitiesã€ã®é …ç›®ã¯ã€Œread contentã€ã«ã—ã¾ã™ã€‚
è¨˜å…¥å¾Œã®ãƒšãƒ¼ã‚¸ã§ã€Œinternal integration tokenã€ãŒå‡ºã‚‹ã®ã§ã‚³ãƒ”ãƒ¼ã—ã¦ä¿ç®¡ã—ã¦ãŠãã¾ã™ã€‚

æ¬¡ã«notionã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’ä½œæˆã—ã¦ã„ãã¾ã™ã€‚
æ–°ã—ã„ãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚ãã®éš›ã«Tableã®é …ç›®ã‚’é¸æŠã—ã¾ã™ã€‚

https://gyazo.com/e2c595ff2c5708b533b213d5e49fc8b5

ä»Šå›ã¯ä½œæˆã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ã€ŒTitleã€ã€ŒContentã€ã«ã—ã€ã©ã¡ã‚‰ã‚‚ãƒ†ã‚­ã‚¹ãƒˆå‹ã«ã—ã¦ã„ã¾ã™ã€‚
ã„ãã¤ã‹ãƒ‡ãƒ¼ã‚¿ã‚’å…¥åŠ›ã—ã¦ãŠãã¾ã™ã€‚

3ç‚¹ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã®ã€ŒAdd connectionã€ã‹ã‚‰ç¾åœ¨ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æŒ‡å®šã—ã€å…±æœ‰ã‚’æœ‰åŠ¹ã«ã—ã¾ã™ã€‚
database idã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®urlã®`ã€œnotion.so/`ã®ã‚ã¨ã‹ã‚‰`?v=ã€œ`ã¾ã§ã®32æ¡ã®å€¤ã«ãªã‚Šã¾ã™ã€‚ã“ã¡ã‚‰ã‚‚å¾Œç¨‹ä½¿ç”¨ã™ã‚‹ã®ã§ä¿ç®¡ã—ã¦ãŠãã¾ã™ã€‚


## Next.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ

`yarn create next-app`
ã§Next.jsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã™ã€‚

https://gyazo.com/dff1ee3f9ce4a285211c0bc303aa9523

## Notion SDK for JavaScriptã®å°å…¥

`yarn add @notionhq/client`
ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.envãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã€ä¿ç®¡ã—ã¦ãŠã„ãŸã€Œinternal integration tokenã€ã¨ã€Œdatabase idã€ã‚’è¨˜å…¥ã—ã¾ã™ã€‚

```
NOTION_TOKEN="secret_your_integration-token"
NOTION_DATABASE_ID="your_database_id"
```

page.tsx
```jsx
async function getData() {
  const notion = new Client({ auth: process.env.NOTION_TOKEN})
  const data = await notion.databases.query({ database_id: process.env.NOTION_DATABASE_ID || '' })
  const notionList = data.results.map((_: any) => _.properties).map((_) => {
    return {
      title: _.title.title[0]?.plain_text,
      description: _.description.rich_text[0]?.plain_text,
    }
  })
  return notionList
}

```

RSCã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã®ã§ä¸Šè¨˜ã®é–¢æ•°å†…ã«å‡¦ç†ã‚’è¨˜è¿°ã—ã¦ã„ãã¾ã™ã€‚

æ¬¡ã«notion clientã®åˆæœŸåŒ–ã‚’è¡Œã„ã¾ã™ã€‚queryã‚’ä½¿ç”¨ã—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å€¤ã‚’å–å¾—ã—ã¾ã™ã€‚

https://developers.notion.com/reference/post-database-query

ã“ã®éš›ã€å‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã™ã‚‹ã®ã§ `|| ''` ã“ã¡ã‚‰ã®è¨˜è¿°ã‚’è¡Œã„ã¾ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®å€¤ã‚’åˆ©ç”¨ã—ã‚„ã™ã„ã‚ˆã†ã«åŠ å·¥ã—ãŸå¾Œã€notionListã‚’è¿”ã™ã‚ˆã†ã«ã—ã¾ã™ã€‚
getDataé–¢æ•°ã‚’åˆ©ç”¨ã—ã¦ãƒ–ãƒ©ã‚¦ã‚¶è¡¨ç¤ºã—ã¦ã„ãã¾ã™ã€‚

```jsx
import { Client } from "@notionhq/client"

export default async function Page() {
  const list = await getData()
  return (
    <div className="pl-[20px] mt-[60px] w-full max-w-[800px] mx-auto">
      <h2 className="text-[28px] font-bold text-center mb-[32px]">Notion Database æ—¥è¨˜</h2>
      <ul className="mt-4 border p-[24px] rounded-md">
        {list.map((item, index) => (
          <li key={index} className="mb-[20px] border rounded-md p-[24px] bg-gray-900">
            <div className="text-[16px] mb-[8px]"><span>Title:</span><p className="text-[20px] pt-1">{item.title}</p></div>
            <div className="text-[16px]"><span>Content:</span><p className="text-[20px] pt-1">{item.description}</p></div>
          </li>
        ))}
      </ul>
    </div>
  )
}

// å…ˆã»ã©è¨˜å…¥ã—ãŸå†…å®¹
async function getData() {
  const notion = new Client({ auth: process.env.NOTION_TOKEN})
  const data = await notion.databases.query({ database_id: process.env.NOTION_DATABASE_ID || '' })
  const notionList = data.results.map((_: any) => _.properties).map((_) => {
    return {
      title: _.title.title[0]?.plain_text,
      description: _.description.rich_text[0]?.plain_text,
    }
  })
  return notionList
}

```

`const list = await getData()`
â†‘ã“ã¡ã‚‰ã®è¨˜è¿°ã§`title`ã¨`description`ã‚’å«ã‚€`notionList`ã‚’å–å¾—ã§ãã¾ã™ã€‚

æœ€å¾Œã«mapãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ã‚’ãƒ«ãƒ¼ãƒ—è¡¨ç¤ºã•ã›ã¦å®Œæˆã¨ãªã‚Šã¾ã™ã€‚

https://www.webcreatorbox.com/tech/chatgpt-nextjs-notion